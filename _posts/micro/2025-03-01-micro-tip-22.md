---
layout: post
title: "ìì˜í•œ ë„ì›€ë§ #22 Next.jsì—ì„œ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ì˜ ê´´ë¦¬ê° ì²˜ë¦¬í•˜ê¸°"
subtitle: "Hydration Mismatch"
description: ""
date: 2025-03-17 08:40:00 +0900
category: micro

id: 22
slug: hydration-mismatch
tags: [ğŸ’¡, Front-end, Next.js]

coverImage: "/assets/blog/coverImages/micro-21.png"

ogImage:
  url: "/assets/blog/coverImages/micro-21.png"
---

- Hydration Mismatch
    - Next.js ì‚¬ìš© ì‹œ ë¬¸ì œ
    - ëŒ€í‘œì ìœ¼ë¡œ new Date()
    - https://blog.hwahae.co.kr/all/tech/13604
    - ë¬´ì‹œí•  ìˆ˜ ìˆëŠ” hydration mismatch new Date
    - ë¬´ì‹œí•  ìˆ˜ ì—†ëŠ” hydration mismatch í…Œë§ˆ (store ì´ˆê¸° ì„¤ì •ì‹œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ í…Œë§ˆ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œì—ì„œ ë°œìƒí•œ ë¬¸ì œ, 83ec7fb67b21fb3ebf32ec49e6c1a60ba66f6b67 ì»¤ë°‹ ì°¸ê³ )


```tsx
import { format } from "date-fns";

type Props = {
  dateString: string;
};

const DateFormatter = ({ dateString }: Props) => {
  // Safariì˜ parsing ì•Œê³ ë¦¬ì¦˜ì´ ìœ ë… ì €ì—´í•˜ê¸° ë•Œë¬¸ì— ì „ì²˜ë¦¬
  const date = new Date(
    Date.parse(dateString.replace(" ", "T").replace(" ", ""))
  );

  return (
    <time dateTime={dateString} suppressHydrationWarning>
      {format(date, "LLLL	d, yyyy")}
    </time>
  );
};

export default DateFormatter;
```

```ts
import { useEffect } from "react";
import { create } from "zustand";
import { persist } from "zustand/middleware";

type Store = {
  isDarkMode: boolean;
  toggleDark: () => void;
  setIsDarkMode: (isDarkMode: boolean) => void;
};

const useStore = create<Store>()(
  persist(
    (set) => ({
      isDarkMode: false,
      toggleDark: () => set((state) => ({ isDarkMode: !state.isDarkMode })),
      setIsDarkMode: (isDarkMode) => set((state) => ({ isDarkMode })),
    }),
    { name: "theme-storage" }
  )
);

export const useMatchMedia = () => {
  const { setIsDarkMode } = useStore();

  // useStoreì—ì„œ ë°”ë¡œ window ê°ì²´ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ íŒŒì•…í•˜ë©° isDarkModeë¥¼ ê²°ì •ì§€ì„ ê²½ìš°
  // ì„œë²„ì‚¬ì´ë“œ ë Œë”ë§ê³¼ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì˜ ì´ˆê¸° ìƒíƒœ ì°¨ì´ë¡œ ì¸í•´ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚´
  // ë¨¼ì € ìƒíƒœ ìƒì„± í›„ -> useEffect í›…ìœ¼ë¡œ ì‹œìŠ¤í…œ ì„¤ì •ì„ í™•ì¸
  useEffect(() => {
    const mediaQueryList = window.matchMedia("(prefers-color-scheme: dark)");
    const updateDarkMode = (e: MediaQueryListEvent) => {
      setIsDarkMode(e.matches);
    };

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ í…Œë§ˆ ìƒíƒœê°’ì´ ì—†ë‹¤ë©´ ì‹œìŠ¤í…œ ì„¤ì •ì„ ê°€ì ¸ì˜¨ë‹¤.
    if (!localStorage.getItem("theme-storage"))
      setIsDarkMode(mediaQueryList.matches);

    // ë¦¬ìŠ¤ë„ˆ ë“±ë¡
    mediaQueryList.addEventListener("change", updateDarkMode);

    // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ë¦¬ìŠ¤ë„ˆ ì œê±°
    return () => {
      mediaQueryList.removeEventListener("change", updateDarkMode);
    };
  }, []);
};

export const useDarkMode = () => {
  const { isDarkMode, toggleDark } = useStore();

  return { isDarkMode, toggleDark };
};

export default useStore;
```

## TL;DR

## ì´í•˜ ê·¸ë¦¬ ì¤‘ìš”í•˜ì§„ ì•Šì€ ë‚´ìš©ë“¤

## ë‚´ê°€ ë°°ìš´ ê²ƒ
