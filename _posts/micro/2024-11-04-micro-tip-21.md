---
layout: post
title: "ìì˜í•œ ë„ì›€ë§ #21 querySelectorì˜ ì¸ìì— \"#1\"ì„ ë„£ì—ˆë”ë‹ˆ ê³ ì¥ì´ ë‚©ë‹ˆë‹¤."
description: "CSS escapeì— ëŒ€í•˜ì—¬"
date: 2024-11-04 18:00:00 +0900
category: micro

id: 21
slug: css-escape
tags: [ğŸ’¡, Front-end, CSS]

# coverImage: "/assets/blog/coverImages/micro-21.png"

# ogImage:
#   url: "/assets/blog/coverImages/micro-21.png"
---

## TL;DR

- Web API `Document.querySelector()`: ì¸ìë¡œ ì „ë‹¬ ë°›ì€ CSS ì„ íƒìì™€ ì¼ì¹˜í•˜ëŠ” í˜„ì¬ ì›¹ í˜ì´ì§€ ë‚´ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤.
- ê·¸ëŸ°ë° ë‹¤ìŒê³¼ ê°™ì€ ì„ íƒìë¥¼ ì…ë ¥í•  ê²½ìš° ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
```html
<h2 id="1. ë¸”ë¡œê·¸">1. ë¸”ë¡œê·¸</h2>
```
```javascript
document.querySelector("#1. ë¸”ë¡œê·¸");
// => êµ¬ë¬¸ ì˜¤ë¥˜! ['#1' is not a valid selector.]
```

<p class="center">
<img src="https://i.postimg.cc/J0gZL8qY/image.png"/>
</p>


- ë˜ ë‹¤ë¥¸ Web APIì¸ `CSS.escape()`ë¥¼ ì‚¬ìš©í•´ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
```javascript
CSS.escape("1. ë¸”ë¡œê·¸");
// ë¬¸ìì—´ì„ ë‹¤ìŒìœ¼ë¡œ ë³€í™˜: "\\31 \\.\\ ë¸”ë¡œê·¸"

document.querySelector(CSS.escape("1. ë¸”ë¡œê·¸"));
```
- ìë™ìœ¼ë¡œ ë¬¸ìì—´ì— ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤(Escape Sequence)ë¥¼ ì ìš©í•˜ëŠ” ìœ í‹¸ í•¨ìˆ˜ì´ë‹¤.

## ì´í•˜ ê·¸ë¦¬ ì¤‘ìš”í•˜ì§„ ì•Šì€ ë‚´ìš©ë“¤

### ë°°ê²½

ì§€ë‚œë²ˆ ê¸€ì— ì´ì–´ ì´ë²ˆ ê¸€ë„ ë¸”ë¡œê·¸ë¥¼ ê°œí¸í•˜ë©´ì„œ ê²ªì—ˆë˜ ë¬¸ì œë¥¼ ì£¼ì œë¡œ í•œë‹¤. ìš”ì¦˜ ë‹¬ë¦¬ ê°œì¸ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ì§¬ì´ ì•ˆ ë‚˜ëŠ” ì‹œê¸°ë¥¼ ë³´ë‚´ëŠ” ì¤‘ì´ê¸° ë•Œë¬¸ì— ì´ ë¸”ë¡œê·¸ ê°œí¸ ì‘ì—…ì„ í™”ìˆ˜ë¶„ìœ¼ë¡œ ì‚¼ì•„ ê³„ì† ê¸€ì„ ë½‘ì•„ë‚´ì•¼ í•  ë“¯. ì•„ë¬´íŠ¼ ì˜¤ëŠ˜ ì´ì•¼ê¸°í•´ ë³¼ ê²ƒì€ `querySelector`ì™€ CSS ì„ íƒì.

ë¸”ë¡œê·¸ ê°œí¸í•˜ë©´ì„œ TOCë„ ì§ì ‘ êµ¬í˜„í•˜ëŠ”ê±¸ë¡œ ë°”ê¿¨ìŒ

### ì¦ìƒ

ToC ê¸°ëŠ¥ì˜ êµ¬í˜„ ë°©ë²•ì— ëŒ€í•´  
ë¸”ë¡œê·¸ ê¸€ì€ .md íŒŒì¼ í˜•íƒœë¡œ ì‘ì„±  
ë³€í™˜ ëª¨ë“ˆì— ì˜í•´ ë¸”ë¡œê·¸ ë¹Œë“œì‹œ .md íŒŒì¼ì€ html ì½”ë“œë¡œ ìë™ ë³€í™˜ë¨  
PostBody ì»´í¬ë„ŒíŠ¸ì— ë³€í™˜ëœ HTMLì´ ì‚½ì…ë˜ëŠ” êµ¬ì¡°  
PostBodyëŠ” ì‚½ì…ëœ HTMLì—ì„œ Heading Elementë“¤ì˜ ì •ë³´ë¥¼ ì¶”ì¶œí•´ PostToCì—ê²Œ ì „ë‹¬í•œë‹¤.  
(text, id, level(depth))  
PostToC ì»´í¬ë„ŒíŠ¸ëŠ” ì „ë‹¬ë°›ì€ Heading Element ì •ë³´ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•´ ToCë¥¼ ìƒì„±  

ToCëŠ” ë‹¤ìŒ ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆë‹¤.
- ToCì˜ ì•„ì´í…œì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ë¬¸ë‹¨ìœ¼ë¡œ ì´ë™í•œë‹¤.
- í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ ì‚¬ìš©ìê°€ ì½ê³  ìˆëŠ” ë¬¸ë‹¨ì˜ ì œëª©ì„ ê°•ì¡°í•œë‹¤.


ê·¼ë° "### 1. ë¸”ë¡œê·¸" ì´ëŸ° headingì„ ì¸ì‹í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œ ë°œìƒ

### ì›ì¸

ì¿¼ë¦¬ ì…€ë ‰í„°(querySelectorAll)ì—ì„œ ë°œìƒí•œ ë¬¸ì œ
ì¿¼ë¦¬ ì…€ë ‰í„°ì— ëŒ€í•œ ì„¤ëª…

### í•´ê²°

ìš°ì„  ì´ë ‡ê²Œ ê³ ì³ì£¼ë©´ ëœë‹¤
(ìˆ˜ì • ì½”ë“œ)

### ë¶„ì„

CSS Escapeë€? -> ì•„ì£¼ ê°„ë‹¨í•œ ë¬¸ìì—´ ë³€í™˜ í•¨ìˆ˜

ê·¸ ì™¸ CSS ì¸í„°í˜ì´ìŠ¤ì™€ static methods
https://developer.mozilla.org/ko/docs/Web/API/CSS

## ë‚´ê°€ ë°°ìš´ ê²ƒ

- ToC ê¸°ëŠ¥ì„ ë§Œë“œëŠ” ë°©ë²•
- ì¿¼ë¦¬ ì…€ë ‰í„°
- Web API CSS ì¸í„°í˜ì´ìŠ¤
- CSS Escape

----

- CSS escapeë€?
    - #1 ì„ ì¿¼ë¦¬ ì…€ë ‰í„°ì— ë„£ìœ¼ë©´ ê³ ì¥ë‚œë‹¤.
    - https://stackoverflow.com/questions/20306204/using-queryselector-with-ids-that-are-numbers

- 
- CSS Web APIì— ëŒ€í•´ ì•Œì•„ë³´ì


----


## ìš”ì£¼ì˜ ì½”ë“œ

```jsx
type ToCItem = {
  text: string;
  id: string;
  level: number;
};

function PostToC({ headings }: { headings: ToCItem[] }) {
  const [current, setCurrent] = useState(-1);

  /* í˜„ì¬ heading ê°•ì¡° ê¸°ëŠ¥ */
  useEffect(() => {
    if (headings.length === 0) return;

    const headingEls = document.querySelectorAll(
      headings.map((h) => `#${CSS.escape(h.id)}`).join(", ")
    );

    const observer = new IntersectionObserver(
      ([entry]) => {
        if (entry.isIntersecting) {
          setCurrent(headings.findIndex((h) => h.id === entry.target.id));
        }
      },
      {
        root: null,
        rootMargin: "0% 0% -66% 0%",
        threshold: 1,
      }
    );

    headingEls.forEach((el) => observer.observe(el));

    return () => observer.disconnect();
  }, [headings.length]);

  return (
    <PostToCNav className="toc-rail">
      <div className="toc-container">
        <ul className="toc-core">
          {headings.length > 0
            ? headings.map((heading, idx) => {
                return (
                  <li
                    key={`post-toc-item-${idx}`}
                    className={`${idx === current ? "current-heading" : ""}`}
                  >
                    {Array.from(Array(heading.level), (e, jdx) => {
                      return (
                        <p
                          className="toc-indent"
                          key={`toc-indent-${idx}-${jdx}`}
                        ></p>
                      );
                    })}
                    <a href={`#${heading.id}`}>{heading.text}</a>
                  </li>
                );
              })
            : undefined}
        </ul>
      </div>
    </PostToCNav>
  );
}
```